В этой домашней работе мы добавим обработку исключений в наш магазин, чтобы показывать пользователю ошибку, если он добавляет несуществующий товар в корзину.

Данная работа выполняется в новой ветке старого проекта.

Шаг 1. Свое исключение и модификация сервиса
Добавьте свое исключение
NoSuchProductException
унаследованное от
RuntimeException
.

Во всех местах где используется метод
getProductById
класса
StorageService
, вместо
IllegalArgumentException
нужно выкидывать новое исключение —
NoSuchProductException
.

Шаг 2. Модель ошибки
Ошибку, которая говорит о том что товар не найден, мы будем возвращать пользователю в виде JSON. Для этого нам понадобится отдельный класс, который можно назвать
ShopError
. Он будет немодифицируемым и иметь два строковых поля:

code
: код ошибки в виде строки.
message
: сообщение об ошибке.
Код ошибки часто используют, чтобы получить машиночитаемое значение для ошибки, локализовать ее на нужный язык или выполнить другое действие при получении этой ошибки.

Эти коды обычно отличаются от HTTP-кодов и являются более конкретными. Например: на HTTP-код четыреста могут приходиться несколько разных ошибок с разным смыслом.

Шаг 3. Controller Advice
Вам нужно будет создать класс который называется
ShopControllerAdvice
и написать внутри него обработчик нашего исключения
NoSuchProductException
. Обработчик должен возвращать
ResponseEntity<ShopError>
с HTTP кодом 404.

Выберите код ошибки и сообщение самостоятельно.